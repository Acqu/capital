<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="theme-color" content="#722f37" />
    <meta name="description" content="We Customize The Looks You Wear, While You Wear The Look You Wish! Explore our premium custom clothing and personalized fashion services, designed to match your unique style.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>capitalprint</title>
    <!--<base href="/" />-->
    <link rel="icon" href="./favicon.ico">
    <link rel="stylesheet" href="./css/app.css" />
    <link rel="stylesheet" href="./css/allproducts.css" />
    <link rel="stylesheet" href="./css/bootstrap.css" />
    <link rel="stylesheet" href="./css/bootstrap-grid.css" />
    <link rel="stylesheet" href="./css/bootstrap-reboot.css" />
    <link rel="stylesheet" href="./css/bootstrap-utilities.css" />
    <link rel="stylesheet" href="./css/design.css" />
    <link rel="stylesheet" href="./css/home.css" />
    <link rel="stylesheet" href="./css/MainLayout.css" />
    <link rel="stylesheet" href="./css/solution.css" />
    <link href="manifest.webmanifest" rel="manifest" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    <style>
        .spinner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white;
            z-index: 9999;
            overflow: hidden;
        }

        .spinner-inner {
            width: 100px;
            height: 100px;
            border: 10px solid #f3f3f3;
            border-top: 10px solid mediumvioletred;
            border-radius: 50%;
            animation: spin 2s linear infinite;
            position: relative;
        }

            .spinner-inner img {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 40px;
                height: 40px;
            }

        .animated-text {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            color: mediumvioletred;
            animation: fadeInOut 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeInOut {
            0%, 100% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="spinner">
            <div class="spinner-inner">
                <img src="favicon.ico" alt="CapitalPrint Logo">
            </div>
            <div class="animated-text">We Customize the look you Wear, While You Wear The Look You Wish...</div>
        </div>
    </div>
    <script src="scripts.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="modernizr.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/serviceworker.js')
                    .then((registration) => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch((error) => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
    <script>
        window.scrollToElement = (elementId) => {
            const element = document.getElementById(elementId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }
        function hideLoadingSpinner() {
            const spinner = document.querySelector('.spinner');
            if (spinner) {
                spinner.style.display = 'none';
            } else {
                console.warn('Spinner element not found.');
            }
        }

        function startCarousel() {
            $('#carouselExampleIndicators').carousel();
        }

        document.addEventListener('DOMContentLoaded', () => {
            hideLoadingSpinner();
            startCarousel();
        });

        // Fallback timeout
        setTimeout(() => {
            hideLoadingSpinner();
        }, 3000); // Adjust the time as needed

    </script>
    <script>
        const WHATSAPP_NUMBER = '+233244736472';

        function OpenOrderPopup() {
            const popup = document.getElementById('orderPopup');
            if (popup) {
                popup.style.display = 'block'; // Make the popup visible
                console.log("Order popup is now visible.");
            } else {
                console.error("Order popup element not found!");
            }
        }

        function closeOrderPopup() {
            const popup = document.getElementById('orderPopup');
            if (popup) {
                popup.style.display = 'none'; // Hide the popup
                console.log("Order popup has been closed.");
            } else {
                console.error("Order popup element not found!");
            }
        }

        async function captureModalAndSend() {
            const size = document.getElementById('sizeSelect').value || "Not Specified";
            const itemCount = document.getElementById('itemCount').value;

            // Validate inputs
            if (!itemCount) {
                alert("Please enter a quantity.");
                console.error("Validation failed: Quantity is required.");
                return;
            }

            const modalElement = document.getElementById('productModal');
            if (!modalElement) {
                alert("Modal not found!");
                console.error("Modal element is not available.");
                return;
            }

            try {
                // Temporarily adjust modal styles for full capture
                const originalStyles = {
                    overflow: modalElement.style.overflow,
                    maxHeight: modalElement.style.maxHeight
                };
                modalElement.style.overflow = "visible";
                modalElement.style.maxHeight = "none";

                // Capture the modal content
                console.log("Capturing the modal...");
                const canvas = await html2canvas(modalElement, {
                    useCORS: true,
                    scale: 3, // High resolution
                    windowWidth: document.documentElement.clientWidth,
                    windowHeight: document.documentElement.clientHeight
                });

                // Restore original modal styles
                modalElement.style.overflow = originalStyles.overflow;
                modalElement.style.maxHeight = originalStyles.maxHeight;

                const imageData = canvas.toDataURL('image/png');

                // Upload the modal image to Imgbb
                const IMGBB_API_KEY = '7d66cb3efc20cc0bd383710c214e0999';
                const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                    method: 'POST',
                    body: new URLSearchParams({
                        'image': imageData.split(',')[1]
                    })
                });

                const result = await response.json();
                if (!result.success) {
                    alert("Failed to upload the modal image. Please try again.");
                    console.error("Imgbb Upload Error:", result);
                    return;
                }

                const imageUrl = result.data.url;

                // Prepare WhatsApp message
                const whatsappMessage = `Hello! I would like to place an order.\n\nSize: ${size}\nQuantity: ${itemCount}\nModal Image: ${imageUrl}`;
                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMessage)}`;

                // Navigate to WhatsApp immediately
                console.log("Navigating to WhatsApp...");
                window.open(whatsappUrl, '_blank');
            } catch (error) {
                console.error("Error capturing or uploading the modal:", error);
                alert("An error occurred while processing your request. Please try again.");
            } finally {
                closeOrderPopup(); // Close the order popup after submission
            }
        }
    </script>
    <script>
        async function promptImageUpload() {
            return new Promise((resolve) => {
                const input = document.createElement("input");
                input.type = "file";
                input.accept = "image/*";
                input.onchange = (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => resolve(e.target.result);
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            });
        }

        async function captureAndUploadImage(elementId) {
            const element = document.getElementById(elementId);
            const canvas = await html2canvas(element);
            const imageDataUrl = canvas.toDataURL("image/png");

            console.log("Uploading image to Google...");
            // Implement your Google API upload logic here
        }
        let dragElement = null;
        let offsetX = 0;
        let offsetY = 0;

        function startDrag(event) {
            dragElement = event.target;
            const shirtPreview = document.getElementById("shirt-preview");
            const rect = shirtPreview.getBoundingClientRect();

            offsetX = event.clientX - dragElement.getBoundingClientRect().left;
            offsetY = event.clientY - dragElement.getBoundingClientRect().top;

            document.addEventListener("mousemove", (e) => drag(e, rect));
            document.addEventListener("mouseup", stopDrag);
        }

        function drag(event, boundaries) {
            if (dragElement) {
                const newX = Math.max(boundaries.left, Math.min(event.clientX - offsetX, boundaries.right - dragElement.offsetWidth));
                const newY = Math.max(boundaries.top, Math.min(event.clientY - offsetY, boundaries.bottom - dragElement.offsetHeight));

                dragElement.style.position = "absolute";
                dragElement.style.left = `${newX - boundaries.left}px`;
                dragElement.style.top = `${newY - boundaries.top}px`;
            }
        }

        function stopDrag() {
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("mouseup", stopDrag);
            dragElement = null;
        }

        function makeResizableAndDraggable(element) {
            element.style.resize = "both";
            element.style.overflow = "hidden";
            element.addEventListener("mousedown", startDrag);
        }
        document.addEventListener('click', function (event) {
            const nav = document.querySelector('.nav');
            const menuToggle = document.querySelector('.menu-toggle');
            if (nav && nav.classList.contains('active') &&
                !nav.contains(event.target) &&
                !menuToggle.contains(event.target)) {
                nav.classList.remove('active');
            }
        });
        if (!Modernizr.flexbox) {
            alert("Flexbox is not supported in this browser.");
        }
    </script>
    <script>
        function startCarouselForProducts() {
            console.log("startCarouselForProducts invoked");
        }
    </script>
    <script>
        window.startChangingText = function (elementId, defaultText) {
            const element = document.getElementById(elementId);
            if (!element) {
                console.error(`Element with ID "${elementId}" not found.`);
                return;
            }
            // Use the defaultText as the first message.
            const messages = [
                defaultText,
                "Custom Designs for Every Occasion",
                "Quality, Creativity, and Style",
                "Your Brand, Our Passion"
            ];
            let messageIndex = 0;
            function updateText() {
                element.style.opacity = 0;
                setTimeout(() => {
                    element.textContent = messages[messageIndex];
                    element.style.opacity = 1;
                    messageIndex = (messageIndex + 1) % messages.length;
                }, 300);
            }
            updateText();
            setInterval(updateText, 3000);
        };
    </script>
    <style>
        /* General Popup Style */
        #orderPopup {
            display: none; /* Default hidden */
            position: fixed;
            top: 20%;
            left: 25%; /* Adjusted width for smaller size */
            width: 50%; /* Reduced width */
            padding: 20px;
            background: rgba(255, 255, 255, 0.95); /* Semi-transparent background */
            border: 2px solid #007bff;
            z-index: 9999;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .order-popup-btn {
            font-size: 0.8rem; /* Smaller font for buttons */
            padding: 8px 12px; /* Compact padding */
            margin: 5px;
        }
        /* Smaller Screens (Tablets, Phones) */
        @media (max-width: 768px) {
            #orderPopup {
                top: 5%; /* Adjust popup position for smaller screens */
                left: 5%;
                width: 90%; /* Increase width for smaller devices */
                padding: 15px; /* Adjust padding for compact space */
            }
        }
        /* Extra Small Screens (Mobile Phones) */
        @media (max-width: 480px) {
            #orderPopup {
                top: 2%; /* Ensure no overlapping issues */
                left: 2%;
                width: 95%; /* Expand width for very small devices */
                padding: 10px; /* Reduce padding for tighter layouts */
            }
        }

        .modal {
            z-index: 1040; /* Lower than popup */
        }

        /* Optional: Make Buttons Responsive */
        .btn {
            font-size: 14px; /* Smaller font for buttons */
            padding: 10px 15px;
        }

        /* Form Inputs */
        .form-control {
            font-size: 14px; /* Smaller text for inputs */
        }
    </style>
    <script>
        function closeOrderPopup() {
            const orderPopup = document.getElementById("orderPopup");
            if (orderPopup) {
                orderPopup.style.display = "none"; // Hide the order popup
            }
        }
    </script>
</body>

</html>
