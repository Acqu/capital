<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>capitalprint</title>
    <!--<base href="/" />-->
    <link rel="icon" href="./favicon.ico">
    <link rel="stylesheet" href="./css/app.css" />
    <link rel="stylesheet" href="./css/allproducts.css" />
    <link rel="stylesheet" href="./css/bootstrap.css" />
    <link rel="stylesheet" href="./css/bootstrap-grid.css" />
    <link rel="stylesheet" href="./css/bootstrap-reboot.css" />
    <link rel="stylesheet" href="./css/bootstrap-utilities.css" />
    <link rel="stylesheet" href="./css/design.css" />
    <link rel="stylesheet" href="./css/home.css" />
    <link rel="stylesheet" href="./css/MainLayout.css" />
    <link rel="stylesheet" href="./css/solution.css" />
    <link href="manifest.webmanifest" rel="manifest" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    <style>
        .spinner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white;
            z-index: 9999;
            overflow: hidden;
        }

        .spinner-inner {
            width: 100px;
            height: 100px;
            border: 10px solid #f3f3f3;
            border-top: 10px solid mediumvioletred;
            border-radius: 50%;
            animation: spin 2s linear infinite;
            position: relative;
        }

            .spinner-inner img {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 40px;
                height: 40px;
            }

        .animated-text {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            color: mediumvioletred;
            animation: fadeInOut 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeInOut {
            0%, 100% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="spinner">
            <div class="spinner-inner">
                <img src="favicon.ico" alt="CapitalPrint Logo">
            </div>
            <div class="animated-text">We Customize the look you Wear, While You Wear The Look You Wish...</div>
        </div>
    </div>
    <script src="scripts.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="modernizr.js"></script>
    <script>
        window.scrollToElement = (elementId) => {
            const element = document.getElementById(elementId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }
        function hideLoadingSpinner() {
            const spinner = document.querySelector('.spinner');
            if (spinner) {
                spinner.style.display = 'none';
            } else {
                console.warn('Spinner element not found.');
            }
        }

        function startCarousel() {
            $('#carouselExampleIndicators').carousel();
        }

        document.addEventListener('DOMContentLoaded', () => {
            hideLoadingSpinner();
            startCarousel();
        });

        // Fallback timeout
        setTimeout(() => {
            hideLoadingSpinner();
        }, 3000); // Adjust the time as needed

    </script>
    <script>
        // Constants
        const IMGBB_API_KEY = '7d66cb3efc20cc0bd383710c214e0999';
        const WHATSAPP_NUMBER = '+233244736472';

        // Open the order popup
        function OpenOrderPopup(selectedProduct) {
            const popup = document.getElementById('orderPopup');
            console.log("Popup element found:", popup);

            if (popup) {
                popup.style.display = 'block'; // Show the popup
                popup.style.zIndex = '1050'; // Ensure it appears above the modal
                console.log("Popup should now be visible.");
            } else {
                console.error("Popup element not found!");
            }

            // Store product for later use
            window.selectedProduct = selectedProduct;
            console.log("Selected product:", selectedProduct);
        }

        // Close the order popup
        function closeOrderPopup() {
            const popup = document.getElementById('orderPopup');

            if (popup) {
                popup.style.display = 'none';
            }
        }

        // Process the order
        async function processOrder() {
            const size = document.getElementById('sizeSelect').value;
            const itemCount = document.getElementById('itemCount').value;

            // Validate inputs
            if (!size || !itemCount) {
                alert("Please enter both size and item count.");
                return;
            }

            // Capture product image
            const modalImage = document.querySelector('.modal-image');
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = modalImage.naturalWidth || modalImage.width;
            canvas.height = modalImage.naturalHeight || modalImage.height;
            ctx.drawImage(modalImage, 0, 0, canvas.width, canvas.height);

            // Convert to Data URL
            const imageData = canvas.toDataURL('image/png');
            console.log("Captured Image Data:", imageData);

            try {
                // Upload to Imgbb
                const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                    method: 'POST',
                    body: new URLSearchParams({
                        'image': imageData.split(',')[1]
                    })
                });

                const result = await response.json();
                console.log("Imgbb Response:", result);

                if (result.success) {
                    const imageUrl = result.data.url;
                    console.log("Image successfully uploaded:", imageUrl);

                    // Create WhatsApp message
                    const productName = window.selectedProduct?.Name || "Unnamed Product";
                    const whatsappMessage = `Hello! I would like to place an order.\n\nProduct: ${productName}\nSize: ${size}\nQuantity: ${itemCount}\nImage URL: ${imageUrl}`;
                    const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMessage)}`;

                    // Navigate to WhatsApp
                    console.log("Navigating to WhatsApp:", whatsappUrl);
                    window.open(whatsappUrl, '_blank');
                } else {
                    alert("Failed to upload the image. Please try again.");
                    console.error("Imgbb Error:", result);
                }
            } catch (error) {
                console.error("Error during order processing:", error);
                alert("An error occurred. Please try again.");
            } finally {
                closeOrderPopup();
            }
        }
    </script>
    <script>
        async function promptImageUpload() {
            return new Promise((resolve) => {
                const input = document.createElement("input");
                input.type = "file";
                input.accept = "image/*";
                input.onchange = (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => resolve(e.target.result);
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            });
        }

        async function captureAndUploadImage(elementId) {
            const element = document.getElementById(elementId);
            const canvas = await html2canvas(element);
            const imageDataUrl = canvas.toDataURL("image/png");

            console.log("Uploading image to Google...");
            // Implement your Google API upload logic here
        }
        //async function captureAndSendImage(elementId, name, color, price, items, size) {
        //    const element = document.getElementById(elementId);
        //    const canvas = await html2canvas(element);
        //    const imageDataUrl = canvas.toDataURL("image/png");

        //    const phoneNumber = "233244736472";
        //    const message = `Name: ${name}\nColor: ${color}\nPrice: GHS ${price}\nItems: ${items}\nSize: ${size}`;
        //    const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;

        //    window.location.href = whatsappUrl;
        //}

        let dragElement = null;
        let offsetX = 0;
        let offsetY = 0;

        function startDrag(event) {
            dragElement = event.target;
            const shirtPreview = document.getElementById("shirt-preview");
            const rect = shirtPreview.getBoundingClientRect();

            offsetX = event.clientX - dragElement.getBoundingClientRect().left;
            offsetY = event.clientY - dragElement.getBoundingClientRect().top;

            document.addEventListener("mousemove", (e) => drag(e, rect));
            document.addEventListener("mouseup", stopDrag);
        }

        function drag(event, boundaries) {
            if (dragElement) {
                const newX = Math.max(boundaries.left, Math.min(event.clientX - offsetX, boundaries.right - dragElement.offsetWidth));
                const newY = Math.max(boundaries.top, Math.min(event.clientY - offsetY, boundaries.bottom - dragElement.offsetHeight));

                dragElement.style.position = "absolute";
                dragElement.style.left = `${newX - boundaries.left}px`;
                dragElement.style.top = `${newY - boundaries.top}px`;
            }
        }

        function stopDrag() {
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("mouseup", stopDrag);
            dragElement = null;
        }

        function makeResizableAndDraggable(element) {
            element.style.resize = "both";
            element.style.overflow = "hidden";
            element.addEventListener("mousedown", startDrag);
        }
        document.addEventListener('click', function (event) {
            const nav = document.querySelector('.nav');
            const menuToggle = document.querySelector('.menu-toggle');
            if (nav && nav.classList.contains('active') &&
                !nav.contains(event.target) &&
                !menuToggle.contains(event.target)) {
                nav.classList.remove('active');
            }
        });
        if (!Modernizr.flexbox) {
            alert("Flexbox is not supported in this browser.");
        }
    </script>
    <script>
        function startCarouselForProducts() {
            console.log("startCarouselForProducts invoked");
        }
    </script>
    <script>
        window.startChangingText = function (elementId, defaultText) {
            const element = document.getElementById(elementId);
            if (!element) {
                console.error(`Element with ID "${elementId}" not found.`);
                return;
            }
            // Use the defaultText as the first message.
            const messages = [
                defaultText,
                "Custom Designs for Every Occasion",
                "Quality, Creativity, and Style",
                "Your Brand, Our Passion"
            ];
            let messageIndex = 0;
            function updateText() {
                element.style.opacity = 0;
                setTimeout(() => {
                    element.textContent = messages[messageIndex];
                    element.style.opacity = 1;
                    messageIndex = (messageIndex + 1) % messages.length;
                }, 300);
            }
            updateText();
            setInterval(updateText, 3000);
        };
    </script>
    <style>
        /* General Popup Style */
        #orderPopup {
            display: none; /* Default hidden */
            position: fixed;
            top: 10%; /* Centered vertically for all screens */
            left: 10%; /* Centered horizontally for all screens */
            width: 80%; /* Dynamic width for responsiveness */
            max-width: 500px; /* Limit maximum size for larger screens */
            padding: 20px;
            background: white;
            border: 2px solid #007bff;
            z-index: 9999; /* Ensure it's on top */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 10px; /* Smooth edges for modern design */
        }

        /* Smaller Screens (Tablets, Phones) */
        @media (max-width: 768px) {
            #orderPopup {
                top: 5%; /* Adjust popup position for smaller screens */
                left: 5%;
                width: 90%; /* Increase width for smaller devices */
                padding: 15px; /* Adjust padding for compact space */
            }
        }

        /* Extra Small Screens (Mobile Phones) */
        @media (max-width: 480px) {
            #orderPopup {
                top: 2%; /* Ensure no overlapping issues */
                left: 2%;
                width: 95%; /* Expand width for very small devices */
                padding: 10px; /* Reduce padding for tighter layouts */
            }
        }

        .modal {
            z-index: 1040; /* Lower than popup */
        }

        /* Optional: Make Buttons Responsive */
        .btn {
            font-size: 14px; /* Smaller font for buttons */
            padding: 10px 15px;
        }

        /* Form Inputs */
        .form-control {
            font-size: 14px; /* Smaller text for inputs */
        }
    </style>
</body>

</html>
